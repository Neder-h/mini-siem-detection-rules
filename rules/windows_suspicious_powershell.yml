title: Suspicious PowerShell Execution
id: 22222222-2222-2222-2222-222222222222
description: Flags PowerShell launches with encoded commands or download cradles commonly used in adversary toolchains.
status: stable
logsource:
  product: windows
  service: sysmon
  category: process_creation
detection:
  selection1:
    process_name: powershell.exe
    command_line|contains: -EncodedCommand
  selection2:
    process_name: powershell.exe
    command_line|contains: "IEX (New-Object Net.WebClient"
  condition: selection1 or selection2
fields:
  - process_name
  - command_line
  - parent_process_name
falsepositives: Legitimate automation that relies on encoded modules; verify with automation owners before escalating.
level: high